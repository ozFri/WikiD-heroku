{% extends "layout.html" %}
{% block body %}
{% if session.username %}
<h3>Add a Statement</h3>
<form action="{{ url_for('add_I_Node') }}" method="post">
    <dl>
        <dt>Title:</dt>
        <dd><input type="text" size="30" name="title"></dd>
        <!--            <dt>Tags (separated by commas):</dt>
            <dd><input type="text" size="30" name="tags"></dd>
            <dt>Text:</dt>
            <dd><textarea name="text" rows="5" cols="40"></textarea></dd>-->
    </dl>
    <input type="submit" value="Share">
</form>
{% endif %}
<div class="post-header">
    <h2 id="aifnode-title">
    {% if "INode" in aifnode.type() %}
    {{aifnode.title}}
    <a id="edit-button" class="btn btn-link" onclick="editTitle()">edit</a>
    {% endif %}
    {% if "SNode" in aifnode.type() %}
        <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=aifnode.source_id)}}">"{{ aifnode.source}}"</a>
        {{ aifnode.schema }}  
        <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=aifnode.target_id)}}">"{{ aifnode.target}}"</a>
    {% endif %}
    <a class="btn btn-link" href="{{ url_for('delete_aifnode', aifnode_id=aifnode.id)}}">delete</a><br>
    </h2>
    {{aifnode.date}}
</div>
<div class="container">
    <div class="row">
        <div class="col-sm-3">
        </div>  
        <div class="col-md-2 bg-success">
            <a class="btn btn-success" href="{{ url_for('vote_on_aifnode', aifnode_id=aifnode.id, vote_type='Agree') }}">agree</a><br>
            {{agree_votes}} agreeing
        </div>  
        <div class="col-md-2 bg-danger">
            <a class="btn btn-danger" href="{{ url_for('vote_on_aifnode', aifnode_id=aifnode.id, vote_type='Disagree') }}">disagree</a><br>
            {{disagree_votes}} disagreeing
        </div>  
        <div class="col-md-2 bg-warning">
            <a class="btn btn-warning" href="{{ url_for('vote_on_aifnode', aifnode_id=aifnode.id, vote_type='Undecided') }}">undecided</a><br>
            {{undecided_votes}} undecided
        </div>  
        <div class="col-sm-3">
        </div>  
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-lg-6">
        <div class="panel panel-primary">
            <div class="row">
            <form method="Post" action="{{ url_for('add_S_node',aifnode_id=aifnode.id) }}">
            <div class="col-sm-5">
                <select name="source" id="fuzzDrop1">
                    {% for row in aifnode.aifnodes %}
                    <option value={{ loop.index }}>{{ row.aifnode.title }}</option> 
                    {% endfor %}
                </select>
                <div id="fuzzSearch">
                    <div id="fuzzNameContainer">
                        <span class="fuzzName"></span>
                        <span class="fuzzArrow"></span>
                    </div>
                    <div id="fuzzDropdownContainer">
                        <input type="text" value="" class="fuzzMagicBox" placeholder="search.." />
                        <span class="fuzzSearchIcon"></span>
                        <ul id="fuzzResults">
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-sm-2">
                <select name="schema" class="schema-select">
                    <option>supports</option>
                    <option>opposes</option>
                </select>
            </div>
            <div class="col-sm-5">
                {{aifnode.title}}
            </div>
            </div>
            <div class="row">
                <input type="submit" class="SNode-submit btn btn-default" value="Submit">
            </div>
            </div>
            </form>
            <ul class="panel panel-success" >
                <h4 class="panel-heading">Supporting propositions</h4>
                {% for row in supporting_nodes %}
                <li>
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.source_id)}}">"{{ row.snode.source}}"</a>
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.id)}}">  {{ row.snode.schema }}  </a>
                    &nbsp"{{ row.snode.target }}"
                </li>
                    {% endfor %}        
            </ul>
            <ul class="panel panel-danger" >
                <h4 class="panel-heading">Opposing propositions</h4>
                {% for row in opposing_nodes %}
                <li>
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.source_id)}}">"{{ row.snode.source }}"</a>
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.id)}}">  {{ row.snode.schema }}  </a>
                    &nbsp"{{ row.snode.target }}"
                </li>
                    {% endfor %}        
            </ul>
        </div>
        <div class="col-lg-6">
        <div class="panel panel-primary">
        <div class="row">
            <form method="POST" action="{{ url_for('add_S_node',aifnode_id=aifnode.id) }}">
            <div class="col-sm-5">
                {{aifnode.title}}
            </div>
            <div class="col-sm-2">
                <select name="schema" class="schema-select">
                    <option>supports</option>
                    <option>opposes</option>
                </select>
            </div>
            <div class="col-sm-5">
                <select name="target" id="fuzzDrop2">
                    {% for row in aifnode.aifnodes %}
                    <option value={{loop.index}}>{{ row.aifnode.title }}</option> 
                    {% endfor %}
                </select>
                <div id="fuzzSearch2">
                    <div id="fuzzNameContainer">
                        <span class="fuzzName"></span>
                        <span class="fuzzArrow"></span>
                    </div>
                    <div id="fuzzDropdownContainer">
                        <input type="text" value="" class="fuzzMagicBox" placeholder="search.." />
                        <span class="fuzzSearchIcon"></span>
                        <ul id="fuzzResults2">
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <input class="SNode-submit btn btn-default" type="submit" value="Submit">
        </div>
        </div>
        </form>
            <ul class="panel panel-success">
                <h4 class="panel-heading">Supported propositions</h4>
                {% for row in supported_nodes %}
                <li>
                    "{{row.snode.source}}"
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.id)}}">  {{ row.snode.schema }}  </a>
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.target_id)}}"> "{{ row.snode.target}}"</a>
                </li>
                {% endfor %}        
            </ul>
            <ul class="panel panel-danger">
                <h4 class="panel-heading">Opposed propositions</h4>
                {% for row in opposed_nodes %}
                <li>
                    "{{row.snode.source}}"
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.id)}}">"{{ row.snode.schema }}"</a>
                    <a class="aifnode-title" href="{{ url_for('aifNode', aifnode_id=row.snode.target_id)}}"> "{{ row.snode.target}}"</a>
                </li>
                {% endfor %}        
            </ul>
        </div>
    </div>
</div>
<script>
    $('#fuzzDrop1').fuzzyDropdown({
        mainContainer: '#fuzzSearch',
        arrowUpClass: 'fuzzArrowUp',
        selectedClass: 'selected',
        enableBrowserDefaultScroll: true,
        highlightClass: 'highlight'
    });
    $('#fuzzDrop2').fuzzyDropdown({
        mainContainer: '#fuzzSearch2',
        arrowUpClass: 'fuzzArrowUp',
        selectedClass: 'selected',
        enableBrowserDefaultScroll: true,
        highlightClass: 'highlight'
    });
</script>


<script type="text/JavaScript">
function editTitle(){
  var title = document.getElementById("aifnode-title");
  var titleEdit = document.createElement("input");
  var editButton = document.getElementById("edit-button");
  var confirmButton = document.createElement("a");
  confirmButton.innerHTML = "confirm";
  title.parentNode.replaceChild(titleEdit, title);
  editButton.parentNode.replaceChild(confirmButton, editButton);
  }
</script>
{% endblock %}
